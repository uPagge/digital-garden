---
aliases: 
tags:
  - –∑—Ä–µ–ª–æ—Å—Ç—å/üå±
date:
  - - 2024-04-07
zero-link:
  - "[[00 Nginx]]"
parents: 
linked: 
link: https://struchkov.dev/blog/ru/nginx-optimization/#%D0%BE%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B-%D1%81%D0%BE%D0%B5%D0%B4%D0%B8%D0%BD%D0%B5%D0%BD%D0%B8%D0%B9
---
–ù–∞—á–Ω–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é —Å –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∏ —Å—Ä–æ–∫–∏ –∏—Ö –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è.

```nginx
worker_processes  auto;
worker_priority     -2;
...
events {
    worker_connections  2048;
    multi_accept on;
}
...
http {
    ...
    keepalive_timeout          45;
    reset_timedout_connection  on;
    client_body_timeout        35;
    client_header_timeout      12;
    send_timeout               30;
    ...
    client_body_buffer_size    10K;
    client_header_buffer_size   1k;
    client_max_body_size        8m;
    large_client_header_buffers 4 4k;
    ...
}
```

`worker_processes`¬†- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤. –û–±—ã—á–Ω–æ, –≤—ã—Å—Ç–∞–≤–ª—è—é—Ç —Ä–∞–≤–Ω–æ–º—É —á–∏—Å–ª—É —è–¥–µ—Ä, –Ω–æ –≤ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –µ–≥–æ –ª—É—á—à–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≤ auto. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 1.

`worker_connections`¬†- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –æ–¥–Ω–æ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, —Ç–æ –µ—Å—Ç—å nginx –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å¬†`worker_processes`¬†*¬†`worker_connections`, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å—Ç–∞–≤–∏—Ç—å –≤ –æ—á–µ—Ä–µ–¥—å. –°–ª–µ–¥—É–µ—Ç –≤—ã–±–∏—Ä–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç 1024 –¥–æ 4096. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 512.

`multi_accept`¬†- –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π. –ò–Ω–∞—á–µ, –ø—Ä–æ—Ü–µ—Å—Å nginx –∑–∞ –æ–¥–∏–Ω —Ä–∞–∑ –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é off.

`keepalive_timeout`¬†- –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è keepalive-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –≤ —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ –Ω–µ–º—É –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç. –î–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º, —Å—Ç–æ–∏—Ç –≤—ã—Å—Ç–∞–≤–∏—Ç—å –æ—Ç 30 –¥–æ 50. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ 45. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 75.

`reset_timedout_connection`¬†- –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ—Å—Ç–∞–ª —á–∏—Ç–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É, Nginx –±—É–¥–µ—Ç —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –Ω–∏–º. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é off.

`client_body_timeout`¬†- –ñ–¥–µ—Ç –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–∫—É–Ω–¥ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞, –ø–æ—Å–ª–µ —á–µ–≥–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. –¢–∞–π–º–∞—É—Ç –∑–∞–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–∏–æ–¥–∞ –º–µ–∂–¥—É –¥–≤—É–º—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ —á—Ç–µ–Ω–∏—è, –∞ –Ω–µ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤—Å–µ–≥–æ —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞. –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–∏—á–µ–≥–æ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –∑–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π 408 (Request Time-out). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 60.

`client_header_timeout`¬†- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∞–π–º-–∞—É—Ç –¥–ª—è —á—Ç–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞. –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç –≤–µ—Å—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ –≤ —Ç–µ—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –∑–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π 408 (Request Time-out).

`send_timeout`¬†- –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç —á—Ç–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞, Nginx –ø–æ–¥–æ–∂–¥–µ—Ç –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ–∫—É–Ω–¥ –∏ —Å–±—Ä–æ—Å–∏—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 60.

`client_body_buffer_size`¬†- –ó–∞–¥–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞. –ï—Å–ª–∏ —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ –±–æ–ª—å—à–µ –±—É—Ñ–µ—Ä–∞, —Ç–æ –≤—Å–µ —Ç–µ–ª–æ –∏–ª–∏ —Ç–æ–ª—å–∫–æ –µ–≥–æ —á–∞—Å—Ç—å –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª.

`client_header_buffer_size`¬†- –û—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —Ä–∞–∑–º–µ—Ä—É –±—É—Ñ–µ—Ä–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.

`client_max_body_size`¬†- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–æ–ø—É—Å—Ç–∏–º—ã–π —Ä–∞–∑–º–µ—Ä —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞, —É–∫–∞–∑–∞–Ω–Ω—ã–π –≤ –ø–æ–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ "Content-Length". –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –≤ –∑–∞–ø—Ä–æ—Å–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–ª–∏–µ–Ω—Ç—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ 413 (Request Entity Too Large).

`large_client_header_buffers`¬†- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–æ–≤ –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤. –°—Ç—Ä–æ–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–≤—ã—à–∞—Ç—å —Ä–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞, –∏–Ω–∞—á–µ –∫–ª–∏–µ–Ω—Ç—É –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ –æ—à–∏–±–∫–∞ 414 (Request-URI Too Large).