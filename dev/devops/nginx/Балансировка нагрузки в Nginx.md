---
aliases:
  - –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ Nginx
tags:
  - maturity/üå±
date: 2024-10-30
---
–ë–ª–æ–∫ `upstream` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤, –º–µ–∂–¥—É –∫–æ—Ç–æ—Ä—ã–º–∏ nginx –±—É–¥–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã, —Ç–µ–º —Å–∞–º—ã–º –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è [[../../architecture/highload/–ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏|–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏]]. –í –±–ª–æ–∫–µ `upstream` –ø–µ—Ä–µ—á–∏—Å–ª—è—é—Ç—Å—è —Å–µ—Ä–≤–µ—Ä—ã, –º–µ–∂–¥—É –∫–æ—Ç–æ—Ä—ã–º–∏ –±—É–¥–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å—Å—è –Ω–∞–≥—Ä—É–∑–∫–∞.

```nginx
upstream myapp {
	server server1.example.com;
	server server2.example.com;
	server server3.example.com;
}
```

–ó–∞—Ç–µ–º –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –±–ª–æ–∫ `server`, —á—Ç–æ–±—ã –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –≤–∞—à–µ–º—É –±–ª–æ–∫—É `upstream`. –í –±–ª–æ–∫–µ `server` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—É `proxy_pass` –≤–Ω—É—Ç—Ä–∏ `location`, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ:

```nginx
server {
    listen 80;

    location / {
        proxy_pass http://myapp;
    }
}
```
## –ú–µ—Ç–æ–¥ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏
Nginx –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏, –≤–∫–ª—é—á–∞—è round-robin (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é), least-connected –∏ ip-hash. –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–π –º–µ—Ç–æ–¥, –¥–æ–±–∞–≤–∏–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –¥–∏—Ä–µ–∫—Ç–∏–≤—É –≤ –±–ª–æ–∫ `upstream`.

```nginx
upstream myapp {
    least_conn;
    server server1.example.com;
    server server2.example.com;
    server server3.example.com;
}
```
## –†–µ–∑–µ—Ä–≤–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞
–ß—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã, –∫ –∫–æ—Ç–æ—Ä—ã–º –±—É–¥—É—Ç –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –∑–∞–ø—Ä–æ—Å—ã, –µ—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã:

```nginx
upstream myapp {
    server server1.example.com;
    server server2.example.com;
    server server3.example.com;
    server backup.example.com backup;
}
```
***
## –ú–µ—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
**–û–±–ª–∞—Å—Ç—å**:: [[../../../meta/zero/00 Nginx|00 Nginx]]
**–†–æ–¥–∏—Ç–µ–ª—å**:: 
**–ò—Å—Ç–æ—á–Ω–∏–∫**:: 
**–°–æ–∑–¥–∞–Ω–∞**:: [[2024-10-30]]
**–ê–≤—Ç–æ—Ä**:: 
### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
- 

### –î–æ—á–µ—Ä–Ω–∏–µ –∑–∞–º–µ—Ç–∫–∏
<!-- QueryToSerialize: LIST FROM [[]] WHERE contains(–†–æ–¥–∏—Ç–µ–ª—å, this.file.link) or contains(parents, this.file.link) -->

